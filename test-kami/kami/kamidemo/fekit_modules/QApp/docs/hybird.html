<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QApp Document 混合开发</title>
    <link href="source/bootstrap.min.css" rel="stylesheet">
    <link href="source/patch.css" rel="stylesheet">
    <link href="source/docs.min.css" rel="stylesheet">
    <link rel="stylesheet" href="source/highlight.min.css">
    <style>
        blockquote.api {
            padding: 0 10px;
            border-left-color: #1b809e;
            margin-top: 50px;
        }

        table.table {
            border: 1px solid #1b809e;
        }

        table.table>tbody>tr>th {
            border-top: none;
        }

        h4 {
            padding: 20px 0 10px 0;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
<a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>


<!-- Docs master nav -->
<header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <nav id="bs-navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="http://ued.qunar.com/mobile/">X1</a>
                </li>
                <li class="active">
                    <a href="index.html">QApp</a>
                </li>
                <li>
                    <a href="http://ued.qunar.com/mobile/kami/">Kami</a>
                </li>
                <li>
                    <a href="http://ued.qunar.com/mobile/yo/demo/">Yo</a>
                </li>
                <li>
                    <a href="http://hy.qunar.com/source/qunarapi.html">QunarAPI</a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<!-- Docs page layout -->

<hr style="border-color: #6f5499; margin: 0"/>

<header class="navbar navbar-static-top bs-docs-nav">
    <div class="container">
        <nav class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                
                <li class="">
                    <a href="index.html">简介</a>
                </li>
                
                <li class="">
                    <a href="getting-started.html">起步</a>
                </li>
                
                <li class="">
                    <a href="api.html">API</a>
                </li>
                
                <li class="active">
                    <a href="hybird.html">混合开发</a>
                </li>
                
                <li class="">
                    <a href="plugins.html">插件</a>
                </li>
                
                <li class="">
                    <a href="other.html">其他相关</a>
                </li>
                
                <li class="">
                    <a href="about.html">关于 QApp</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


<div class="container bs-docs-container">
    
    <div class="row">
        <div class="col-md-9" role="main">
            
            
            <div class="bs-docs-section">
            
            <h1 id="简介" class="page-header">简介</h1>
            
            <p>QApp 不仅支持移动 Web 端，而且支持混合开发 Hybrid 模式。</p>

<p>为了让开发者，更好的开发 Hybrid 应用，
QApp 从设计上偏向 Native App 的同时，
也提供一系列的适配 Hybrid 的解决方案，
让开发者可以将基于 QApp 的移动 Web 应用无缝移植到 Hybrid 环境中。</p>

<p>迄今为止，QApp 主要是适配的是去哪儿 Hybrid 解决方案 <a href="http://hy.qunar.com/">Hy</a>。</p>
            </div>
            
            
            
            <div class="bs-docs-section">
            
            <h1 id="QApp-Hy" class="page-header">QApp-Hy</h1>
            
            
            </div>
            
            
            
            <div class="bs-docs-section">
            
            <h2 id="QApp-Hy-说明" class="page-header">说明</h2>
            
            <h4>简介</h4>

<p><strong>QApp</strong> 对 <strong>Hy</strong> 的适配器，只要简单配置，即可让 <strong>Touch</strong> 页正常运行在 <strong>Hy</strong> 环境的大客户端里，并适配到多种环境。</p>

<h4>安装方式</h4>

<blockquote><p>fekit install QApp-Hy@0.2.1</p></blockquote>

<p>或使用 <a href="other.html#FEKit的ginstall命令">fekit ginstall</a> 插件安装。</p>

<h4>项目地址</h4>

<blockquote><p><code>Git</code>: <a href="git@gitlab.corp.qunar.com:qapp/qapp-hy.git">git@gitlab.corp.qunar.com:qapp/qapp-hy.git</a></p></blockquote>

<h4>使用方式</h4>

<blockquote><p>QApp.hy.config(opts)</p></blockquote>

<p>配置后，正常使用 <code>QApp</code> 即可，会自动适配Hy环境</p>

<h4>示例</h4>

<pre><code>// 一般的配置，一般情况下，用户只需要配置这两项即可，有特殊需求的，才需要多配置
QApp.hy.config({
     indexView: &#39;index&#39;,
     viewOptions: {
        // 相见下方详细配置实例
     }
});

// 基础配置信息
QApp.hy.config({
    // 指定首视图。值为视图的名字
    indexView: &#39;index&#39;,
    // Header的高度，单位 px，会根据 window.dpr 缩放。同时支持 function 类型参数，业务自行计算。 
    hdHeight: 44,
    // WebView 类型 navibar-normal 为有原生导航栏（默认），navibar-none 为 WebView 全屏模式。更多类型，已 Hytive 文档为准。
    webViewType: &#39;navibar-normal&#39;,
    // 是否使用 JSON 形式转换参数（参数以 json 字符串形式添加在 Hash 上）
    jsonParam: false,
    // 是否在刷新 Native Header 同时刷新 H5 Header
    refreshH5Header: false,
    // 构建 H5 Header 的方法
    buildNavHTML: null
    // 页面配置信息。
    viewOptions: {
        // 配置 &#39;index&#39; 页
        index: {
            // 窗口类型
            type: &#39;navibar-normal&#39;, // 默认为 webViewType 配置，可为单独的视图配置
            // 导航栏配置信息
            nav: {
                // 中央标题配置信息
                title: {
                    style: &#39;location&#39;,  // 显示位置图标
                    text: &#39;这是标题&#39;       // 文字内容
                },
                // 左侧区域配置信息。
                left: {
                    style: &#39;icon&#39;,  // 显示图标
                    icon: &#39;f001&#39;, // 图标
                },
                // 右侧区域配置信息。
                right: {
                    style: &#39;text&#39;, // 显示文字
                    text: &#39;分享&#39;  // 文字内容,
                    action: &#39;share&#39; // 特殊操作，以 hytive 支持列表为准，share 为调起 native 分享
                }
            },
            // 绑定事件 （只在 hytive 环境触发）
            bindEvents: {
                // 页面显示时触发的回调
                show: function() {

                },
                // 页面激活时触发的回调
                actived: function() {

                },
                // 页面失活时触发的回调
                deactived: function() {

                },
                // 监听右键点击，支持 left, title, right 等
                &#39;nav:left&#39;: function() {
                    return false; // 阻止 Native 默认逻辑，例如回退逻辑
                    // 在模拟点击的元素上，加 preventNative 标记属性，也可以是此效果
                }
            },
            // 特殊逻辑的配置 （只在 Hytive 环境触发）
            render: function(options, showCallback, hideCallback) {
            }
        },
        // 将 view.a 映射成 url，使用 QApp.open(&#39;view.a&#39;) 相当于打开此 url
        &#39;view.a&#39;: {
            url: &#39;http://waimai.qunar.com/index.jsp&#39;
        },
        // 将 view.b 映射成 schema，使用 QApp.open(&#39;view.b&#39;) 相当于调用此 schema
        &#39;view.b&#39;: {
            schema: &#39;//hotel/main&#39;
        }
    }
    // 全局的绑定
    bindEvents: {},
    // ready 回调
    ready: function() {},
    // 按钮选择器，当用户点击原生组件的按钮时，QApp-Hy 会模拟触发 H5 对相应按钮的 tap 事件
    buttons: {
        left: &#39;header .regret&#39;, // 导航栏左侧按钮
        title: &#39;header .title&#39;, // 标题
        right: &#39;header .affirm&#39; // 导航栏右侧按钮
    }
});

// 环境嗅探 由于 Hy 环境时异步判定，所以请在 QApp.ready 后使用。
QApp.hy.sniff = {
    app: true,  // 是否在 App 中
    qunarApp: false, // 是否是 QunarApp（原 WebView）
    hyApp: true, // 是否是 HyApp
    touch: false, // 是否是 Touch
    pc: false // 是否是在 PC 上模拟
};

// 设备信息 从 QN241 Cookie 中获取
QApp.hy.deviceInfo = {
    cid: &quot;C1001&quot;,
    lt: 0,
    uid: &quot;FDDB3B58-41DE-4093-A4A0-DA62C21897EC&quot;,
    gid: &quot;D23DF3A0-F33F-FF54-F2A8-3561836485C3&quot;,
    pid: &quot;10010&quot;,
    vid: &quot;80011091&quot;  // 客户端版本号，ios 为 8 开头，adr 为 6 开头
};

// 获取的登录信息
// 包括
// isLogin 是否登录
// nickName 昵称
// userName 用户名
var loginInfo = QApp.hy.getLoginInfo();

// 登录
// 兼容 touch 、 Hy 和 独立客户端
// 需要升级 QApp 到 0.4.2
// 在客户端内，有 回调
QApp.hy.login(function(ret) {
    // ret 为登录信息
});</code></pre>
            </div>
            
            
            
            <div class="bs-docs-section">
            
            <h2 id="QApp-Hy-历史版本" class="page-header">历史版本</h2>
            
            <h2>Change Log</h2>

<h3>0.2.1 (2015-09-18)</h3>

<ul><li>修复 backTo 在 Hy 环境中匹配的问题 (例 backTo mail 会匹配到 mail.detail)</li><li>修复 代码 Bug</li></ul>

<h3>0.2.0 (2015-09-08 稳定版)</h3>

<ul><li>增加 多端 Login 的支持</li><li>支持 hdHeight 支持 根据 window.dpr 计算同时支持 function 类型参数</li><li>优化 代码</li></ul>

<h3>0.1.4 (2015-08-24)</h3>

<ul><li>增加 全屏 WebView 模式的支持</li><li>增加 对 Native 动作的拦截机制</li><li>增加 对 H5 （主要是 Header 上按钮）选择器的配置</li><li>增加 jsonParam 配置，支持参数以 JSON 形式附在 Hash 上（保持数据字段原始类型，仅支持在 Hy 中）</li><li>优化 兼容版本判断逻辑</li><li>优化 QApp.router.back 的逻辑</li><li>修复 在老 WebView 上的展示问题</li></ul>

<h3>0.1.3 (2015-08-14)</h3>

<ul><li>整合 0.1.2 hack 版本的内容，兼容老客户端多 WebView 通信问题。</li><li>增加 bindEvents 绑定方式，绑定事件。</li><li>增加 ready 配置，环境判断完成后，回调。</li><li>增加 info 属性，开发者可以从此获取设备信息（基于 Cookie QN241，并已做多版本兼容）。</li><li>增加 支持视图与 url 的映射。</li><li>优化 QApp.config 和 QApp.hy.config 中 indexView 只需要配置一个。</li><li>优化 QApp.ready 依赖，WebViewJavascriptBridgeReady 完成后，延迟触发 QApp.ready，兼容在 QApp.ready 的回调中，监听不到 WebViewJavascriptBridgeReady 事件的问题。</li></ul>

<h3>0.1.2-hack</h3>

<ul><li>在 0.1.2 基础兼容老版本客户端</li><li>安装方式 <code>fekit ginstall git@gitlab.corp.qunar.com:qapp/qapp-hy.git -t v0.1.2-hack</code></li></ul>

<h3>0.1.2</h3>

<ul><li>支持视图与schema的映射</li><li>fixed：在touch页面调用 refreshHeader 报错的问题</li></ul>

<h3>0.1.1</h3>

<ul><li>IOS和Android，Native Header上返回键，统一逻辑，<em>只能返回一级</em>。</li></ul>

<p>PS：Android 已经支持前端阻止native逻辑，前端调用 Back 逻辑，IOS 尚未支持。
如果业务线想优先支持安卓的返回，而ios只返回一级的情况可以接受，那可以使用 QApp-Hy 的开发版本。
fekit ginstall git@gitlab.corp.qunar.com:qapp/qapp-hy.git -b jsBack-20150731</p>
            </div>
            
            
        </div>
        <div class="col-md-3" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
                <ul class="nav bs-docs-sidenav">
                    
                    <li>
                        <a href="#简介">简介</a>
                        
                    </li>
                    
                    <li>
                        <a href="#QApp-Hy">QApp-Hy</a>
                        
                        <ul class="nav">
                            
                            <li>
                                
                                <a href="#QApp-Hy-说明">
                                    说明
                                </a>
                                
                            </li>
                            
                            <li>
                                
                                <a href="#QApp-Hy-历史版本">
                                    历史版本
                                </a>
                                
                            </li>
                            
                        </ul>
                        
                    </li>
                    
                </ul>
            </nav>
        </div>
    </div>
    
</div>

<!-- Footer
================================================== -->
<footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
        <p>Made By Qunar Hotel FE Mobile Team. © 2014 - 2015<br /> Style Build By <a href="http://bootcss.com">Bootstrap</a></p>
    </div>
</footer>

<script src="source/jquery.min.js"></script>
<script src="source/bootstrap.min.js"></script>
<script src="source/docs.min.js"></script>
<script src="source/highlight.min.js"></script>
<script>
    $(document).ready(function() {
        $('code').each(function(i, block) {
            if (block.innerHTML.indexOf('\n') != -1) {
                var pn = block.parentNode;
                if (pn.tagName.toUpperCase() == 'PRE') {
                    try {
                        hljs.highlightBlock(block);
                    } catch(e) {}
                } else {
                    pn.innerHTML = '<pre><code>' + block.innerHTML + '</code></pre>';
                    try {
                        hljs.highlightBlock(pn.childNodes[0].childNodes[0]);
                    } catch(e) {}
                }
            }
        });
    });
</script>
</body>
</html>
